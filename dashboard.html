<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QUANTUM RIO INVESTMENT ‚Äì Dashboard</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyC6jW448tW3e8m6XVGjOegT8IGJQJERweY",
  authDomain: "quantum-rio-uganda.firebaseapp.com",
  databaseURL: "https://quantum-rio-uganda-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "quantum-rio-uganda",
  storageBucket: "quantum-rio-uganda.appspot.com",
  messagingSenderId: "840875099079",
  appId: "1:840875099079:web:1cd06a78276842a787cfe2",
  measurementId: "G-97G1PNQ9JB"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();
</script>

<style>
*{-webkit-user-select:none;-ms-user-select:none;user-select:none}
body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#001f3f;color:#fff}
.page-content{padding-bottom:1cm}
header{background:#002f6c;display:flex;align-items:center;gap:10px;padding:12px 16px}
header img{height:32px}
header h2{margin:0;font-size:1.2rem}
.announcement{background:#003366;color:#ff0;padding:8px;white-space:nowrap;overflow:hidden}
.announcement span{display:inline-block;padding-left:100%;animation:scroll 16s linear infinite}
@keyframes scroll{0%{transform:translateX(0)}100%{transform:translateX(-100%)}}
.balance-section{text-align:center;background:#002b5c;padding:18px 12px}
.balance-section .email{font-size:.85rem;color:#ffa500}
.balance-section .balance{font-size:1.4rem;margin:8px 0;color:#ffcc00}
.balance-buttons{display:flex;justify-content:space-around;margin-top:10px}
.balance-buttons button{background:#ffcc00;color:#000;border:none;border-radius:8px;padding:8px 0;width:90px;font-weight:600;cursor:pointer}
.extra-info{text-align:center;padding:16px}
.extra-info img{max-width:92%;border-radius:8px;margin-bottom:12px}
.extra-info p{font-size:.9rem;line-height:1.4}
.claim-btn{background:#ffcc00;color:#000;font-weight:700;border:none;border-radius:8px;padding:8px 18px;cursor:pointer}
.task-countdown{background:#001a33;text-align:center;padding:8px;font-weight:600;color:#ffcc00}
.vip-list{padding:10px}
.vip-box{display:flex;justify-content:space-between;align-items:center;background:#003366;padding:10px;margin:6px 0;border-radius:8px;
  box-shadow:0 0 10px 1px rgba(255,215,0,0.2), inset 0 0 10px rgba(255,215,0,0.1);
  animation:gold-glow 3s ease-in-out infinite alternate;}
@keyframes gold-glow{
  from{box-shadow:0 0 10px 1px rgba(255,215,0,0.2), inset 0 0 10px rgba(255,215,0,0.1);}
  to{box-shadow:0 0 25px 3px rgba(255,215,0,0.6), inset 0 0 15px rgba(255,215,0,0.3);}
}
.vip-box img{height:38px}
.vip-box .info{flex-grow:1;margin-left:8px}
.vip-box .info .amount{font-weight:600;color:#ffcc00}
.vip-box .arrow{font-size:22px;cursor:pointer}
nav{position:fixed;bottom:0;left:0;right:0;display:flex;justify-content:space-around;background:#002244;padding:8px 0}
nav a{color:#fff;text-decoration:none;text-align:center;font-size:.8rem}
nav i{font-size:18px}
.popup{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#28a745;color:#fff;padding:16px 20px;border-radius:8px;font-weight:600;z-index:9999;text-align:center}
.popup.red{background:#cc0000}

/* üîÑ Loader */
#loader{
  position:fixed;
  top:0;left:0;width:100%;height:100%;
  background:#001f3f;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  z-index:10000;
}
.loader-spinner{
  width:70px;height:70px;
  border:6px solid rgba(255,215,0,0.2);
  border-top:6px solid gold;
  border-radius:50%;
  animation:spin 1s linear infinite;
}
@keyframes spin{100%{transform:rotate(360deg)}}
#loader p{color:#ffd700;font-weight:bold;margin-top:10px;font-size:1rem;}
.hidden{opacity:0;visibility:hidden;transition:opacity .5s ease;}
</style>
</head>
<body>

<div id="loader">
  <div class="loader-spinner"></div>
  <p>Loading Dashboard...</p>
</div>

<div class="page-content" style="display:none;">
  <header>
    <img src="https://png.pngtree.com/png-clipart/20221216/original/pngtree-vip-icon-design-png-image_8749175.png" alt="logo">
    <h2>QUANTUM RIO INVESTMENT</h2>
  </header>

  <div class="announcement"><span>üõíWelcome to QUANTUM RIO INVESTMENT üõí Recruiting investors and agents worldwide!</span></div>

  <div class="balance-section">
    <div class="email" id="user-email">loading...</div>
    <div class="balance" id="user-balance">Balance: UGX 0</div>
    <div class="balance-buttons">
      <button onclick="location.href='depositbonus.html'">Deposit</button>
      <button onclick="location.href='withdraw.html'">Withdraw</button>
      <button onclick="location.href='company.html'">Company</button>
    </div>
  </div>

  <div class="extra-info">
    <img src="https://media.istockphoto.com/id/841526170/photo/three-business-people-in-the-office-working-together.jpg?s=170667a&w=0&k=20&c=58v5HeRzpzV3qusfD33JuF0j4Am5rbBYhkc37ozCv84=">
    <p>
      Improve VIP task rules on the same day. Upgrading the VIP level on the same day allows you to complete multiple tasks without restriction.
      You are now VIP1 and have completed today's task. You can upgrade to VIP2 to continue completing VIP2 tasks. Highest VIP level is VIP10.
    </p>
    <button class="claim-btn" id="claim-btn">Claim 1000 UGX</button>
  </div>

  <div class="task-countdown">Task Reset Countdown: <span id="countdown"></span></div>

  <div class="vip-list" id="vip-list"></div>
</div>

<nav>
  <a href="dashboard.html"><i class="fas fa-home"></i><br>Home</a>
  <a href="task.html"><i class="fas fa-tasks"></i><br>Task</a>
  <a href="team.html"><i class="fas fa-users"></i><br>Team</a>
  <a href="vip.html"><i class="fas fa-crown"></i><br>VIP</a>
  <a href="profile.html"><i class="fas fa-user"></i><br>Me</a>
</nav>

<script>
auth.onAuthStateChanged(user=>{
  if(!user){window.location='signin.html';return;}
  const uid=user.uid;
  document.getElementById('user-email').textContent=user.email;

  const loader=document.getElementById('loader');
  const page=document.querySelector('.page-content');

  // show page only when Firebase balance loads
  db.ref('users/'+uid+'/balance').on('value',snap=>{
    const bal=parseFloat(snap.val()||0);
    document.getElementById('user-balance').textContent=`Balance: UGX ${bal.toLocaleString()}`;
    loader.classList.add('hidden');
    setTimeout(()=>page.style.display='block',300);
  });

  const vipAmounts=[400000,600000,800000,1000000,1500000,2000000,3000000,4000000,5000000,6000000];
  const vipNames=["Starter","Basic","Silver","Gold","Platinum","Diamond","Elite","VIP Pro","Executive","Ultimate"];
  const vipList=document.getElementById('vip-list');

  function renderVipLevels(unlocked=[]){
    vipList.innerHTML='';
    vipAmounts.forEach((amt,idx)=>{
      const lvl=idx+1;
      const isUnlocked=unlocked.includes(lvl);
      const box=document.createElement('div');
      box.className='vip-box';
      box.innerHTML=`
        <img src="https://png.pngtree.com/png-clipart/20221216/original/pngtree-vip-icon-design-png-image_8749175.png">
        <div class="info">
          <p>${vipNames[idx]} Plan ‚Äì Unlock amount: <span class="amount">UGX ${amt.toLocaleString()}</span></p>
          <p>${isUnlocked ? "‚úÖ" : "üîê"} VIP${lvl}</p>
          <p>Income will be available in 24 hrs</p>
        </div>
        <div class="arrow">¬ª</div>
      `;
      box.querySelector('.arrow').onclick=()=>showPopup(isUnlocked?"VIP already unlocked":"Please unlock your VIP first",!isUnlocked);
      vipList.appendChild(box);
    });
  }

  renderVipLevels([]);

  db.ref('users/'+uid+'/unlockedVips').on('value',snap=>{
    const raw=snap.val()||{};
    const unlocked=[];
    Object.keys(raw).forEach(amountStr=>{
      const amount=parseInt(amountStr,10);
      const idx=vipAmounts.indexOf(amount);
      if(idx!==-1)unlocked.push(idx+1);
    });
    renderVipLevels(unlocked);
  });

  const claimBtn=document.getElementById('claim-btn');
  const userRef=db.ref('users/'+uid);
  userRef.child('hasClaimedBonus').once('value').then(snap=>{
    if(snap.val()){claimBtn.textContent='Completed';claimBtn.disabled=true;}
  });
  claimBtn.onclick=()=>{
    if(claimBtn.disabled)return;
    userRef.transaction(userData=>{
      userData=userData||{};
      if(userData.hasClaimedBonus)return userData;
      const current=parseFloat(userData.balance||0);
      userData.balance=current+1000;
      userData.hasClaimedBonus=true;
      return userData;
    },(error,committed)=>{
      if(error)showPopup('Error claiming bonus',true);
      else if(committed){
        claimBtn.textContent='Completed';
        claimBtn.disabled=true;
        showPopup('1000 UGX Claimed');
      }
    });
  };

  startCountdown();
});

function startCountdown(){
  const c=document.getElementById('countdown');
  let start=localStorage.getItem('cStart')||Date.now();
  localStorage.setItem('cStart',start);
  setInterval(()=>{
    let diff=86400000-(Date.now()-start);
    if(diff<=0){start=Date.now();localStorage.setItem('cStart',start);diff=86400000;}
    const h=Math.floor(diff/3600000),m=Math.floor((diff%3600000)/60000),s=Math.floor((diff%60000)/1000);
    c.textContent=`${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
  },1000);
}

function showPopup(msg,red=false){
  const p=document.createElement('div');
  p.className='popup'+(red?' red':'');
  p.textContent=msg;
  document.body.appendChild(p);
  setTimeout(()=>p.remove(),3000);
}
</script>
</body>
</html>
